<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>SLikeNet: Source/src/TeamBalancer.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SLikeNet
   &#160;<span id="projectnumber">0.1.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.xhtml"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.xhtml"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.xhtml"><span>Modules</span></a></li>
      <li><a href="../../namespaces.xhtml"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.xhtml"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.xhtml"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.xhtml"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.xhtml"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dc/d8f/_team_balancer_8cpp_source.xhtml','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">TeamBalancer.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dc/d8f/_team_balancer_8cpp.xhtml">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *  Original work: Copyright (c) 2014, Oculus VR, Inc.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  All rights reserved.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *  This source code is licensed under the BSD-style license found in the</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *  RakNet License.txt file in the licenses directory of this source tree. An additional grant </span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *  of patent rights can be found in the RakNet Patents.txt file in the same directory.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *  Modified work: Copyright (c) 2017, SLikeSoft UG (haftungsbeschr√§nkt)</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *  This source code was modified by SLikeSoft. Modifications are licensed under the MIT-style</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *  license found in the license.txt file in the root directory of this source tree.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/ddb/_native_feature_includes_8h.xhtml">slikenet/NativeFeatureIncludes.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#if _RAKNET_SUPPORT_TeamBalancer==1</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml" title="Set and network team selection (supports peer to peer or client/server)">slikenet/TeamBalancer.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/dc3/_bit_stream_8h.xhtml" title="This class allows you to write and read native types as a string of bits.">slikenet/BitStream.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/d83/_message_identifiers_8h.xhtml" title="All the message identifiers used by RakNet. Message identifiers comprise the first byte of any messag...">slikenet/MessageIdentifiers.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d85/peerinterface_8h.xhtml" title="An interface for RakPeer. Simply contains all user functions as pure virtuals.">slikenet/peerinterface.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d10/_rand_8h.xhtml" title="[Internal] Random number generator">slikenet/Rand.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">using namespace </span>SLNet;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">enum</span> TeamBalancerOperations</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    ID_STATUS_UPDATE_TO_NEW_HOST,</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    ID_CANCEL_TEAM_REQUEST,</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    ID_REQUEST_ANY_TEAM,</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    ID_REQUEST_SPECIFIC_TEAM</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;};</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<a class="code" href="../../db/dbd/_export_8h.xhtml#aa00165c970bdb25e1c757b432509533b">STATIC_FACTORY_DEFINITIONS</a>(<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#de/ddd/class_s_l_net_1_1_team_balancer" title="Set and network team selection (supports peer to peer or client/server)">TeamBalancer</a>,<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#de/ddd/class_s_l_net_1_1_team_balancer" title="Set and network team selection (supports peer to peer or client/server)">TeamBalancer</a>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a898d01e933eb35120408113ecf7ee575">TeamBalancer::TeamBalancer</a>()</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ad27f26da1665bd2c57dc78b37a43ffa0">defaultAssigmentAlgorithm</a>=<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a9de4a32384ccb28ce300c12d481ae4a8a16f2fe8d8b3fd59cb2170af9fc6e4936" title="Among all the teams, join the team with the smallest number of players.">SMALLEST_TEAM</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#acc6eb35f9bf7f2c362e2630b221e1127">forceTeamsToBeEven</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#adf1751df350b21316db4b20146cc9a41">lockTeams</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa3c42a43e69f0241998fa7733ae7d5b0">hostGuid</a>=<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a242c86300509ec068e5e2ea534bbba51">UNASSIGNED_RAKNET_GUID</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a83455c14968af3761eba2c33474c1657">TeamBalancer::~TeamBalancer</a>()</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa96a5ab0c1bd5f10e456a1a25483a574" title="Set the limit to the number of players on the specified team.">TeamBalancer::SetTeamSizeLimit</a>(<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> team, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> limit)</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a953b497c5f51b0b4f98089c08ad15696" title="Replace the value at position by input.">Replace</a>(limit,0,team,<a class="code" href="../../d8/db0/defines_8h.xhtml#a8661ec2137eef33a8cd0cd618a748871">_FILE_AND_LINE_</a>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>() &gt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>())</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a953b497c5f51b0b4f98089c08ad15696" title="Replace the value at position by input.">Replace</a>(0,0,<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>()-1,<a class="code" href="../../d8/db0/defines_8h.xhtml#a8661ec2137eef33a8cd0cd618a748871">_FILE_AND_LINE_</a>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a464759563733e4fbd6c621058f370a6c" title="Determine how players&#39; teams will be set when they call RequestAnyTeam()">TeamBalancer::SetDefaultAssignmentAlgorithm</a>(DefaultAssigmentAlgorithm daa)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// Just update the default. Currently active teams are not affected.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ad27f26da1665bd2c57dc78b37a43ffa0">defaultAssigmentAlgorithm</a>=daa;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa1d03ef430401b2d1956f7982367254f" title="By default, teams can be unbalanced up to the team size limit defined by SetTeamSizeLimits()">TeamBalancer::SetForceEvenTeams</a>(<span class="keywordtype">bool</span> force)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;{</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">// Set flag to indicate that teams should be even.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#acc6eb35f9bf7f2c362e2630b221e1127">forceTeamsToBeEven</a>=force;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">// If teams are locked, just return.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#adf1751df350b21316db4b20146cc9a41">lockTeams</a>==<span class="keyword">true</span>)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#acc6eb35f9bf7f2c362e2630b221e1127">forceTeamsToBeEven</a>==<span class="keyword">true</span>)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="comment">// Run the even team algorithm</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a2d429bcbe44e0a87b84331cb015ce8a5">EvenTeams</a>();</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a3088a7c6fd42d37fb4a35380d821eba8" title="If set, calls to RequestSpecificTeam() and RequestAnyTeam() will return the team you are currently on...">TeamBalancer::SetLockTeams</a>(<span class="keywordtype">bool</span> lock)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;{</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">if</span> (lock==<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#adf1751df350b21316db4b20146cc9a41">lockTeams</a>)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// Set flag to indicate that teams can no longer be changed.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#adf1751df350b21316db4b20146cc9a41">lockTeams</a>=lock;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// If lock is false, and teams were set to be forced as even, then run through the even team algorithm</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#adf1751df350b21316db4b20146cc9a41">lockTeams</a>==<span class="keyword">false</span>)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="comment">// Process even swaps</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> i,j;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">for</span> (i=0; i &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); i++)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[i].requestedTeam!=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                <span class="keywordflow">for</span> (j=i+1; j &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); j++)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[j].requestedTeam==<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[i].currentTeam &amp;&amp;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[i].requestedTeam==<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[j].currentTeam)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                    {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a76e20bdfc5228c50474115d26677d4a5">SwapTeamMembersByRequest</a>(i,j);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a640c6b8c086c6d5ed53eb255a8bb2c37">NotifyTeamAssigment</a>(i);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a640c6b8c086c6d5ed53eb255a8bb2c37">NotifyTeamAssigment</a>(j);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#acc6eb35f9bf7f2c362e2630b221e1127">forceTeamsToBeEven</a>==<span class="keyword">true</span>)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a2d429bcbe44e0a87b84331cb015ce8a5">EvenTeams</a>();</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="comment">// Process requested team changes</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="comment">// Process movement while not full</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keywordflow">for</span> (i=0; i &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); i++)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> requestedTeam = <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[i].requestedTeam;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <span class="keywordflow">if</span> (requestedTeam!=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[requestedTeam]&lt;<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>[requestedTeam])</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6c690cbd636eeecd6ad99dd0ab4ea761">SwitchMemberTeam</a>(i,requestedTeam);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a640c6b8c086c6d5ed53eb255a8bb2c37">NotifyTeamAssigment</a>(i);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;}</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a132923a39d6643a7c88af4b2b9eec0bd">TeamBalancer::RequestSpecificTeam</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aa616a13e58b2ffd2c3161609610b256d">NetworkID</a> memberId, <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> desiredTeam)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">bool</span> foundMatch=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); i++)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].memberId==memberId)</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            foundMatch=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].requestedTeam==desiredTeam &amp;&amp; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].currentTeam==desiredTeam)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].requestedTeam=desiredTeam;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (foundMatch==<span class="keyword">false</span>)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        MyTeamMembers mtm;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        mtm.currentTeam=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        mtm.memberId=memberId;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        mtm.requestedTeam=desiredTeam;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a771fc63e3b0d892fbb605a379a78bacb" title="Push an element at the end of the stack.">Push</a>(mtm, <a class="code" href="../../d8/db0/defines_8h.xhtml#a8661ec2137eef33a8cd0cd618a748871">_FILE_AND_LINE_</a>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// Send desiredTeam to the current host.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// Also flag that we have requested a team, and record desiredTeam in case the host changes and it needs to be resent.</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">BitStream</a> bsOut;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5b5b9eb3be9ad636af02da44b718a75f" title="First byte of a network message.">MessageID</a>)<a class="code" href="../../d6/d83/_message_identifiers_8h.xhtml#ac1b471af280629f5ace02e586d5bcfd3acf6ce76bb1659b52dc57966effb554c4">ID_TEAM_BALANCER_INTERNAL</a>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5b5b9eb3be9ad636af02da44b718a75f" title="First byte of a network message.">MessageID</a>)ID_REQUEST_SPECIFIC_TEAM);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(memberId);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(desiredTeam);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#adac8deadf450a4e1d69c11b1db588bec">rakPeerInterface</a>-&gt;<a class="code" href="../../da/d27/class_s_l_net_1_1_rak_peer_interface.xhtml#ab817d74d4aa4ff1edf593543bbf7b8fb">Send</a>(&amp;bsOut,<a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#a659378374e516180f93640c79f59705cacb1785f11dd02aa7f5d164fb314c594e">HIGH_PRIORITY</a>,<a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#ae41fa01235e99dced384d137fa874a7eaff2d39b163bcf3e142744962bfb0849f">RELIABLE_ORDERED</a>,0,<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa3c42a43e69f0241998fa7733ae7d5b0">hostGuid</a>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a8934a135d01d47a641c495fb905e35cf">TeamBalancer::CancelRequestSpecificTeam</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aa616a13e58b2ffd2c3161609610b256d">NetworkID</a> memberId)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); i++)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].memberId==memberId)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].requestedTeam=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="comment">// Send packet to the host to remove our request flag.</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">BitStream</a> bsOut;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5b5b9eb3be9ad636af02da44b718a75f" title="First byte of a network message.">MessageID</a>)ID_TEAM_BALANCER_INTERNAL);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5b5b9eb3be9ad636af02da44b718a75f" title="First byte of a network message.">MessageID</a>)ID_CANCEL_TEAM_REQUEST);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(memberId);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#adac8deadf450a4e1d69c11b1db588bec">rakPeerInterface</a>-&gt;<a class="code" href="../../da/d27/class_s_l_net_1_1_rak_peer_interface.xhtml#ab817d74d4aa4ff1edf593543bbf7b8fb">Send</a>(&amp;bsOut,<a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#a659378374e516180f93640c79f59705cacb1785f11dd02aa7f5d164fb314c594e">HIGH_PRIORITY</a>,<a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#ae41fa01235e99dced384d137fa874a7eaff2d39b163bcf3e142744962bfb0849f">RELIABLE_ORDERED</a>,0,<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa3c42a43e69f0241998fa7733ae7d5b0">hostGuid</a>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;}</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6e50cf20321164f472efca558c632f7a">TeamBalancer::RequestAnyTeam</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aa616a13e58b2ffd2c3161609610b256d">NetworkID</a> memberId)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;{</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordtype">bool</span> foundMatch=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); i++)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].memberId==memberId)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            foundMatch=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].currentTeam!=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].requestedTeam=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span> (foundMatch==<span class="keyword">false</span>)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        MyTeamMembers mtm;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        mtm.currentTeam=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        mtm.memberId=memberId;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        mtm.requestedTeam=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a771fc63e3b0d892fbb605a379a78bacb" title="Push an element at the end of the stack.">Push</a>(mtm, <a class="code" href="../../d8/db0/defines_8h.xhtml#a8661ec2137eef33a8cd0cd618a748871">_FILE_AND_LINE_</a>);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// Else send to the current host that we need a team.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">BitStream</a> bsOut;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5b5b9eb3be9ad636af02da44b718a75f" title="First byte of a network message.">MessageID</a>)ID_TEAM_BALANCER_INTERNAL);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5b5b9eb3be9ad636af02da44b718a75f" title="First byte of a network message.">MessageID</a>)ID_REQUEST_ANY_TEAM);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(memberId);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#adac8deadf450a4e1d69c11b1db588bec">rakPeerInterface</a>-&gt;<a class="code" href="../../da/d27/class_s_l_net_1_1_rak_peer_interface.xhtml#ab817d74d4aa4ff1edf593543bbf7b8fb">Send</a>(&amp;bsOut,<a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#a659378374e516180f93640c79f59705cacb1785f11dd02aa7f5d164fb314c594e">HIGH_PRIORITY</a>,<a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#ae41fa01235e99dced384d137fa874a7eaff2d39b163bcf3e142744962bfb0849f">RELIABLE_ORDERED</a>,0,<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa3c42a43e69f0241998fa7733ae7d5b0">hostGuid</a>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;}</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#af131f68b964334ebfb3c48597bbc9475">TeamBalancer::GetMyTeam</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aa616a13e58b2ffd2c3161609610b256d">NetworkID</a> memberId)<span class="keyword"> const</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// Return team returned by last ID_TEAM_BALANCER_TEAM_ASSIGNED packet</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); i++)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].memberId==memberId)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].currentTeam;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;}</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a1d71b6439f557d5e4d97bea6f13ce995">TeamBalancer::DeleteMember</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aa616a13e58b2ffd2c3161609610b256d">NetworkID</a> memberId)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;{</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); i++)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].memberId==memberId)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a351a647150169c71cc3f758dbb312096" title="Delete the element at position position.">RemoveAtIndexFast</a>(i);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); i++)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[i].memberId==memberId)</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a33ce4a6628986e97ac968e48ef57386d">RemoveTeamMember</a>(i);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#ga5c8f613a7c294e0b96deccbdabc38f18">PluginReceiveResult</a> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ae2c16e062bb407f3b504101172ba8f31">TeamBalancer::OnReceive</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#d8/d23/struct_s_l_net_1_1_packet" title="This represents a user message from another system.">Packet</a> *packet)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">switch</span> (packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aff6d115daef2787d582f9a20efd64fc0" title="The data from the sender.">data</a>[0])</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/d83/_message_identifiers_8h.xhtml#ac1b471af280629f5ace02e586d5bcfd3a6e185e616ae184abde909e8f3e0bdeb3">ID_FCM2_NEW_HOST</a>:</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa3c42a43e69f0241998fa7733ae7d5b0">hostGuid</a>=packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a4f42e82893aff6aade8a45c79d1b8fd3">guid</a>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>()&gt;0)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">BitStream</a> bsOut;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5b5b9eb3be9ad636af02da44b718a75f" title="First byte of a network message.">MessageID</a>)ID_TEAM_BALANCER_INTERNAL);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5b5b9eb3be9ad636af02da44b718a75f" title="First byte of a network message.">MessageID</a>)ID_STATUS_UPDATE_TO_NEW_HOST);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a389b1cb2d6ab054a9949efe7f1748374">WriteCasted</a>&lt;<a class="code" href="../../df/df2/_native_types_8h.xhtml#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&gt;(<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>());</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); i++)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].memberId);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].currentTeam);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].requestedTeam);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#adac8deadf450a4e1d69c11b1db588bec">rakPeerInterface</a>-&gt;<a class="code" href="../../da/d27/class_s_l_net_1_1_rak_peer_interface.xhtml#ab817d74d4aa4ff1edf593543bbf7b8fb">Send</a>(&amp;bsOut,<a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#a659378374e516180f93640c79f59705cacb1785f11dd02aa7f5d164fb314c594e">HIGH_PRIORITY</a>,<a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#ae41fa01235e99dced384d137fa874a7eaff2d39b163bcf3e142744962bfb0849f">RELIABLE_ORDERED</a>,0,<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa3c42a43e69f0241998fa7733ae7d5b0">hostGuid</a>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">case</span> ID_TEAM_BALANCER_INTERNAL:</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="keywordflow">if</span> (packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a75dfd0a23cc4c14dd338caedabe19341" title="The length of the data in bytes.">length</a>&gt;=2)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="keywordflow">switch</span> (packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aff6d115daef2787d582f9a20efd64fc0" title="The data from the sender.">data</a>[1])</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    <span class="keywordflow">case</span> ID_STATUS_UPDATE_TO_NEW_HOST:</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a519d012d011d33aa973a61a83970e475">OnStatusUpdateToNewHost</a>(packet);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                    <span class="keywordflow">case</span> ID_CANCEL_TEAM_REQUEST:</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aad394dd08c0703909ff762275061eb82">OnCancelTeamRequest</a>(packet);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                    <span class="keywordflow">case</span> ID_REQUEST_ANY_TEAM:</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a158e27e06ab926f63cf01f29c3bcf400">OnRequestAnyTeam</a>(packet);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                    <span class="keywordflow">case</span> ID_REQUEST_SPECIFIC_TEAM:</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a5bcaece749161cc5b25b07d94d4925b1">OnRequestSpecificTeam</a>(packet);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#gga5c8f613a7c294e0b96deccbdabc38f18a9f27ed7ccb7513dceb7ed4da3d99a1bf" title="The plugin used this message and it shouldn&#39;t be given to the user.">RR_STOP_PROCESSING_AND_DEALLOCATE</a>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/d83/_message_identifiers_8h.xhtml#ac1b471af280629f5ace02e586d5bcfd3a42266a19aa17158f228bf0baaec39e6d" title="Team balancer plugin informing you of your team. Byte 1 contains the team you requested to join...">ID_TEAM_BALANCER_TEAM_ASSIGNED</a>:</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#af36e3ddab2655bc7beae5366edff5597">OnTeamAssigned</a>(packet);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/d83/_message_identifiers_8h.xhtml#ac1b471af280629f5ace02e586d5bcfd3a1f19168e95bb4a33feccb5e04c662817">ID_TEAM_BALANCER_REQUESTED_TEAM_FULL</a>:</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#adab0082143b910fd28cf75b4f6e66db8">OnRequestedTeamChangePending</a>(packet);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/d83/_message_identifiers_8h.xhtml#ac1b471af280629f5ace02e586d5bcfd3ac083d8c4da64d860c0ef882c6e140a94">ID_TEAM_BALANCER_REQUESTED_TEAM_LOCKED</a>:</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ae23db2796a8c0b2e12c2e3a80be599d6">OnTeamsLocked</a>(packet);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// Got RequestSpecificTeam</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// If teams are locked</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">// - If this user already has a team, return ID_TEAM_BALANCER_TEAMS_LOCKED</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">// - This user does not already have a team. Assign a team as if the user called RequestAnyTeam(), with a preference for the requested team. Return ID_TEAM_BALANCER_TEAM_ASSIGNED once the team has been assigned.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">// If teams are not locked</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">// - If even team balancing is on, only assign this user if this would not cause teams to be unbalanced. If teams WOULD be unbalanced, then flag this user as wanting to join this team. Return ID_TEAM_BALANCER_REQUESTED_TEAM_CHANGE_PENDING</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// - If the destination team is full, flag this user as wanting to join this team. Return ID_TEAM_BALANCER_REQUESTED_TEAM_CHANGE_PENDING</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// - Else, join this team. Return ID_TEAM_BALANCER_TEAM_ASSIGNED</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">// Got RequestAnyTeam</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// Put user on a team following the algorithm. No team is set as preferred.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#gga5c8f613a7c294e0b96deccbdabc38f18a5b5a476b87be78212057efd5535345d4" title="This message will be processed by other plugins, and at last by the user.">RR_CONTINUE_PROCESSING</a>;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;}</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#af65cf620daddde4f01805c3ff3b42cc3">TeamBalancer::OnClosedConnection</a>(<span class="keyword">const</span> <a class="code" href="../../d8/dbe/struct_s_l_net_1_1_system_address.xhtml" title="Network address for a system.">SystemAddress</a> &amp;systemAddress, <a class="code" href="../../dd/d3f/struct_s_l_net_1_1_rak_net_g_u_i_d.xhtml">RakNetGUID</a> rakNetGUID, <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#ga4d3ac5ca8821fadad6d22d0267e06803">PI2_LostConnectionReason</a> lostConnectionReason )</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;{</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    (void) systemAddress;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    (void) lostConnectionReason;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6c30b0ac5dacc916966faa7394d5f6cc">RemoveByGuid</a>(rakNetGUID);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;}</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa4f1fbfa06b01665a3d2c5b67839a541" title="Called when the interface is attached.">TeamBalancer::OnAttach</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;{</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa3c42a43e69f0241998fa7733ae7d5b0">hostGuid</a> = <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#adac8deadf450a4e1d69c11b1db588bec">rakPeerInterface</a>-&gt;<a class="code" href="../../da/d27/class_s_l_net_1_1_rak_peer_interface.xhtml#a19e5960d76ee5af2ca108978daa2fcff">GetGuidFromSystemAddress</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#acea7714c995aae0e1feaf79c9e7f073d" title="Index of an invalid SystemAddress.">UNASSIGNED_SYSTEM_ADDRESS</a>);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;}</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6c30b0ac5dacc916966faa7394d5f6cc">TeamBalancer::RemoveByGuid</a>(<a class="code" href="../../dd/d3f/struct_s_l_net_1_1_rak_net_g_u_i_d.xhtml">RakNetGUID</a> rakNetGUID)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;{</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// If we are the host, and the closed connection has a team, and teams are not locked:</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a13952460534e1d57791877d8c5e39d62">WeAreHost</a>())</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> droppedMemberIndex=0;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">while</span> (droppedMemberIndex &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>())</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[droppedMemberIndex].memberGuid==rakNetGUID)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> droppedTeam = <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[droppedMemberIndex].currentTeam;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a33ce4a6628986e97ac968e48ef57386d">RemoveTeamMember</a>(droppedMemberIndex);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#adf1751df350b21316db4b20146cc9a41">lockTeams</a>==<span class="keyword">false</span>)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#acc6eb35f9bf7f2c362e2630b221e1127">forceTeamsToBeEven</a>)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                        <span class="comment">// - teams were forced to be even, then run the even team algorithm</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a2d429bcbe44e0a87b84331cb015ce8a5">EvenTeams</a>();</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                    }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                    {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                        <span class="comment">// - teams were NOT forced to be even, and the team the dropped player on was full, then move users wanting to join that team (if any)</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[ droppedTeam ]==<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>[ droppedTeam ]-1)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                        {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                            <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a72f2dea409a28878b594b1e814285ee9">MoveMemberThatWantsToJoinTeam</a>(droppedTeam);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                        }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                    }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                droppedMemberIndex++;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a519d012d011d33aa973a61a83970e475">TeamBalancer::OnStatusUpdateToNewHost</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#d8/d23/struct_s_l_net_1_1_packet" title="This represents a user message from another system.">Packet</a> *packet)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;{</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a13952460534e1d57791877d8c5e39d62">WeAreHost</a>()==<span class="keyword">false</span>)</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">BitStream</a> bsIn(packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aff6d115daef2787d582f9a20efd64fc0" title="The data from the sender.">data</a>,packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a75dfd0a23cc4c14dd338caedabe19341" title="The length of the data in bytes.">length</a>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    bsIn.IgnoreBytes(2);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="../../df/df2/_native_types_8h.xhtml#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> requestedTeamChangeListSize;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    bsIn.Read(requestedTeamChangeListSize);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    TeamMember tm;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    tm.memberGuid=packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a4f42e82893aff6aade8a45c79d1b8fd3">guid</a>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../df/df2/_native_types_8h.xhtml#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> i=0; i &lt; requestedTeamChangeListSize; i++)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        bsIn.Read(tm.memberId);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        bsIn.Read(tm.currentTeam);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        bsIn.Read(tm.requestedTeam);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">if</span> (tm.currentTeam!=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a> &amp;&amp; tm.currentTeam&gt;<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>())</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>(<span class="stringliteral">&quot;Current team out of range in TeamBalancer::OnStatusUpdateToNewHost&quot;</span> &amp;&amp; 0);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">if</span> (tm.requestedTeam!=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a> &amp;&amp; tm.requestedTeam&gt;<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>())</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>(<span class="stringliteral">&quot;Requested team out of range in TeamBalancer::OnStatusUpdateToNewHost&quot;</span> &amp;&amp; 0);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">if</span> (tm.currentTeam==<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a> &amp;&amp; tm.requestedTeam==<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>)</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> memberIndex = <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ad011d5195729baa60fe85794d24a3dc8">GetMemberIndex</a>(tm.memberId, packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a4f42e82893aff6aade8a45c79d1b8fd3">guid</a>);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">if</span> (memberIndex==(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) -1)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="comment">// Add this system (by GUID) to the list of members if he is not already there</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="comment">// Also update his requested team flag.</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <span class="comment">// Do not process balancing on requested teams, since we don&#39;t necessarily have all data from all systems yet and hopefully the state during the host migration was stable.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keywordflow">if</span> (tm.currentTeam==<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <span class="comment">// Assign a default team, then add team member</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                <span class="keywordflow">if</span> (tm.requestedTeam==<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                    <span class="comment">// Assign a default team</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                    tm.currentTeam=<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a7022b3909c60d61c840248aa9d697467">GetNextDefaultTeam</a>();</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    <span class="comment">// Assign to requested team if possible. Otherwise, assign to a default team</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a93c9124d5f9801ccc15b89aa7ccbef2b">TeamWouldBeOverpopulatedOnAddition</a>(tm.requestedTeam, <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>())==<span class="keyword">false</span>)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                    {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                        tm.currentTeam=tm.requestedTeam;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                    }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                    {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                        tm.currentTeam=<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a7022b3909c60d61c840248aa9d697467">GetNextDefaultTeam</a>();</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <span class="keywordflow">if</span> (tm.currentTeam==<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>)</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>(<span class="stringliteral">&quot;Too many members asking for teams!&quot;</span> &amp;&amp; 0);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a640c6b8c086c6d5ed53eb255a8bb2c37">NotifyTeamAssigment</a>(<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ae9d08d010c25ebf7807918a2a4ac8584">AddTeamMember</a>(tm));</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;}</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aad394dd08c0703909ff762275061eb82">TeamBalancer::OnCancelTeamRequest</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#d8/d23/struct_s_l_net_1_1_packet" title="This represents a user message from another system.">Packet</a> *packet)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;{</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a13952460534e1d57791877d8c5e39d62">WeAreHost</a>()==<span class="keyword">false</span>)</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">BitStream</a> bsIn(packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aff6d115daef2787d582f9a20efd64fc0" title="The data from the sender.">data</a>,packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a75dfd0a23cc4c14dd338caedabe19341" title="The length of the data in bytes.">length</a>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    bsIn.IgnoreBytes(2);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aa616a13e58b2ffd2c3161609610b256d">NetworkID</a> memberId;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    bsIn.Read(memberId);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> memberIndex = <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ad011d5195729baa60fe85794d24a3dc8">GetMemberIndex</a>(memberId, packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a4f42e82893aff6aade8a45c79d1b8fd3">guid</a>);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span> (memberIndex!=(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)-1)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[memberIndex].requestedTeam=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;}</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a158e27e06ab926f63cf01f29c3bcf400">TeamBalancer::OnRequestAnyTeam</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#d8/d23/struct_s_l_net_1_1_packet" title="This represents a user message from another system.">Packet</a> *packet)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;{</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a13952460534e1d57791877d8c5e39d62">WeAreHost</a>()==<span class="keyword">false</span>)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">BitStream</a> bsIn(packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aff6d115daef2787d582f9a20efd64fc0" title="The data from the sender.">data</a>,packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a75dfd0a23cc4c14dd338caedabe19341" title="The length of the data in bytes.">length</a>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    bsIn.IgnoreBytes(2);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aa616a13e58b2ffd2c3161609610b256d">NetworkID</a> memberId;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    bsIn.Read(memberId);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> memberIndex = <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ad011d5195729baa60fe85794d24a3dc8">GetMemberIndex</a>(memberId, packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a4f42e82893aff6aade8a45c79d1b8fd3">guid</a>);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">if</span> (memberIndex==(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)-1)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        TeamMember tm;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        tm.currentTeam=<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a7022b3909c60d61c840248aa9d697467">GetNextDefaultTeam</a>();</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        tm.requestedTeam=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        tm.memberGuid=packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a4f42e82893aff6aade8a45c79d1b8fd3">guid</a>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        tm.memberId=memberId;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="keywordflow">if</span> (tm.currentTeam==<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>)</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>(<span class="stringliteral">&quot;Too many members asking for teams!&quot;</span> &amp;&amp; 0);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a640c6b8c086c6d5ed53eb255a8bb2c37">NotifyTeamAssigment</a>(<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ae9d08d010c25ebf7807918a2a4ac8584">AddTeamMember</a>(tm));</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;}</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a5bcaece749161cc5b25b07d94d4925b1">TeamBalancer::OnRequestSpecificTeam</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#d8/d23/struct_s_l_net_1_1_packet" title="This represents a user message from another system.">Packet</a> *packet)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;{</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a13952460534e1d57791877d8c5e39d62">WeAreHost</a>()==<span class="keyword">false</span>)</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">BitStream</a> bsIn(packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aff6d115daef2787d582f9a20efd64fc0" title="The data from the sender.">data</a>,packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a75dfd0a23cc4c14dd338caedabe19341" title="The length of the data in bytes.">length</a>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    bsIn.IgnoreBytes(2);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    TeamMember tm;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    bsIn.Read(tm.memberId);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    bsIn.Read(tm.requestedTeam);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> memberIndex = <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ad011d5195729baa60fe85794d24a3dc8">GetMemberIndex</a>(tm.memberId, packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a4f42e82893aff6aade8a45c79d1b8fd3">guid</a>);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">if</span> (tm.requestedTeam==<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a144df7a27a6f10e9aabe676a762d9270">NotifyNoTeam</a>(tm.memberId, packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a4f42e82893aff6aade8a45c79d1b8fd3">guid</a>);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">if</span> (memberIndex != (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) -1)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a33ce4a6628986e97ac968e48ef57386d">RemoveTeamMember</a>(memberIndex);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">if</span> (tm.requestedTeam&gt;<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>())</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>(<span class="stringliteral">&quot;Requested team out of range in TeamBalancer::OnRequestSpecificTeam&quot;</span> &amp;&amp; 0);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">if</span> (memberIndex==(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) -1)</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        tm.memberGuid=packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a4f42e82893aff6aade8a45c79d1b8fd3">guid</a>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="comment">// Assign to requested team if possible. Otherwise, assign to a default team</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a93c9124d5f9801ccc15b89aa7ccbef2b">TeamWouldBeOverpopulatedOnAddition</a>(tm.requestedTeam, <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>())==<span class="keyword">false</span>)</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            tm.currentTeam=tm.requestedTeam;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            tm.requestedTeam=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            tm.currentTeam=<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a7022b3909c60d61c840248aa9d697467">GetNextDefaultTeam</a>();</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">if</span> (tm.currentTeam==<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>(<span class="stringliteral">&quot;Too many members asking for teams!&quot;</span> &amp;&amp; 0);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a640c6b8c086c6d5ed53eb255a8bb2c37">NotifyTeamAssigment</a>(<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ae9d08d010c25ebf7807918a2a4ac8584">AddTeamMember</a>(tm));</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[memberIndex].requestedTeam=tm.requestedTeam;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> oldTeamThisUserWasOn = <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[memberIndex].currentTeam;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#adf1751df350b21316db4b20146cc9a41">lockTeams</a>)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a1b5a34d8101604857f0a575fc6c6f23c">NotifyTeamsLocked</a>(packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a4f42e82893aff6aade8a45c79d1b8fd3">guid</a>, tm.requestedTeam);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="comment">// Assign to requested team if possible. Otherwise, assign to a default team</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a3767f4e0d9ff145ca455ca423fb9687c">TeamsWouldBeEvenOnSwitch</a>(tm.requestedTeam,oldTeamThisUserWasOn)==<span class="keyword">true</span>)</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6c690cbd636eeecd6ad99dd0ab4ea761">SwitchMemberTeam</a>(memberIndex,tm.requestedTeam);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a640c6b8c086c6d5ed53eb255a8bb2c37">NotifyTeamAssigment</a>(memberIndex);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="comment">// If someone wants to join this user&#39;s old team, and we want to join their team, they can swap</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> swappableMemberIndex;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            <span class="keywordflow">for</span> (swappableMemberIndex=0; swappableMemberIndex &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); swappableMemberIndex++)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[swappableMemberIndex].currentTeam==tm.requestedTeam &amp;&amp; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[swappableMemberIndex].requestedTeam==oldTeamThisUserWasOn)</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <span class="keywordflow">if</span> (swappableMemberIndex!=<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>())</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a76e20bdfc5228c50474115d26677d4a5">SwapTeamMembersByRequest</a>(memberIndex,swappableMemberIndex);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a640c6b8c086c6d5ed53eb255a8bb2c37">NotifyTeamAssigment</a>(memberIndex);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a640c6b8c086c6d5ed53eb255a8bb2c37">NotifyTeamAssigment</a>(swappableMemberIndex);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                <span class="comment">// Full or would not be even</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a3d933edb5bdd683ac8c7457ea77d5193">NotifyTeamSwitchPending</a>(packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a4f42e82893aff6aade8a45c79d1b8fd3">guid</a>, tm.requestedTeam, tm.memberId);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        }   </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;}</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ad011d5195729baa60fe85794d24a3dc8">TeamBalancer::GetMemberIndex</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aa616a13e58b2ffd2c3161609610b256d">NetworkID</a> memberId, <a class="code" href="../../dd/d3f/struct_s_l_net_1_1_rak_net_g_u_i_d.xhtml">RakNetGUID</a> guid)<span class="keyword"> const</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); i++)</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[i].memberGuid==guid &amp;&amp; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[i].memberId==memberId)</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) -1;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;}</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ae9d08d010c25ebf7807918a2a4ac8584">TeamBalancer::AddTeamMember</a>(<span class="keyword">const</span> TeamMember &amp;tm)</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;{</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">if</span> (tm.currentTeam&gt;<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>())</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>(<span class="stringliteral">&quot;TeamBalancer::AddTeamMember team index out of bounds&quot;</span> &amp;&amp; 0);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) -1;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>(tm.currentTeam!=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a771fc63e3b0d892fbb605a379a78bacb" title="Push an element at the end of the stack.">Push</a>(tm,<a class="code" href="../../d8/db0/defines_8h.xhtml#a8661ec2137eef33a8cd0cd618a748871">_FILE_AND_LINE_</a>);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>()&lt;tm.currentTeam)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a953b497c5f51b0b4f98089c08ad15696" title="Replace the value at position by input.">Replace</a>(1,0,tm.currentTeam,<a class="code" href="../../d8/db0/defines_8h.xhtml#a8661ec2137eef33a8cd0cd618a748871">_FILE_AND_LINE_</a>);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[tm.currentTeam]=<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[tm.currentTeam]+1;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>()-1;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;}</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a33ce4a6628986e97ac968e48ef57386d">TeamBalancer::RemoveTeamMember</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;{</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>( <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[ <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[index].currentTeam ] != 0);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[ <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#abdb68e4cf25b298e97db9eef70007f41">teamMembers</a>[index].currentTeam ]=<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[ teamMembers[index].currentTeam ]-1;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    teamMembers.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a351a647150169c71cc3f758dbb312096" title="Delete the element at position position.">RemoveAtIndexFast</a>(index);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;}</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ad9420e7344c0fb9fb5e480e021d31cac">TeamBalancer::GetMinMaxTeamMembers</a>(<span class="keywordtype">int</span> &amp;minMembersOnASingleTeam, <span class="keywordtype">int</span> &amp;maxMembersOnASingleTeam)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;{</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    minMembersOnASingleTeam = teamMembers.Size()/<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>();</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordflow">if</span> ((teamMembers.Size() % <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>()) == 0)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        maxMembersOnASingleTeam = minMembersOnASingleTeam;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        maxMembersOnASingleTeam = minMembersOnASingleTeam+1;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;}</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a2d429bcbe44e0a87b84331cb015ce8a5">TeamBalancer::EvenTeams</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;{</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="comment">// Ensure all teams are even. If not, pick players at random from overpopulated teams, and move to underpopulated teams.</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordtype">int</span> minMembersOnASingleTeam;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordtype">int</span> maxMembersOnASingleTeam;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ad9420e7344c0fb9fb5e480e021d31cac">GetMinMaxTeamMembers</a>(minMembersOnASingleTeam,maxMembersOnASingleTeam);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="comment">// First select among players that have requested to switch teams, if any, before choosing players that did not want to switch teams.</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">// Players that are moved should be notified of ID_TEAM_BALANCER_TEAM_ASSIGNED</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml" title="Array based implementation of a list.">DataStructures::List&lt;TeamId&gt;</a> overpopulatedTeams;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> teamMemberCountsIndex;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> memberIndexToSwitch;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">for</span> (teamMemberCountsIndex=0; teamMemberCountsIndex&lt;<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); teamMemberCountsIndex++)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">while</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[teamMemberCountsIndex]&lt;minMembersOnASingleTeam &amp;&amp; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[teamMemberCountsIndex]&lt;<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>[teamMemberCountsIndex])</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ae61f6eee03eee5bfe3cd32c973293f03">GetOverpopulatedTeams</a>(overpopulatedTeams,maxMembersOnASingleTeam);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>(overpopulatedTeams.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>()&gt;0);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            memberIndexToSwitch=<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a05ded673b26751d769b168e409469fc3">GetMemberIndexToSwitchTeams</a>(overpopulatedTeams,teamMemberCountsIndex);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>(memberIndexToSwitch!=(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)-1);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6c690cbd636eeecd6ad99dd0ab4ea761">SwitchMemberTeam</a>(memberIndexToSwitch,teamMemberCountsIndex);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <span class="comment">// Tell this member he switched teams</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a640c6b8c086c6d5ed53eb255a8bb2c37">NotifyTeamAssigment</a>(memberIndexToSwitch);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;}</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a05ded673b26751d769b168e409469fc3">TeamBalancer::GetMemberIndexToSwitchTeams</a>(<span class="keyword">const</span> <a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml" title="Array based implementation of a list.">DataStructures::List&lt;TeamId&gt;</a> &amp;sourceTeamNumbers, <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> targetTeamNumber)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;{</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml">DataStructures::List&lt;unsigned int&gt;</a> preferredSwapIndices;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml">DataStructures::List&lt;unsigned int&gt;</a> potentialSwapIndices;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i,j;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">for</span> (j=0; j &lt; sourceTeamNumbers.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); j++)</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>(sourceTeamNumbers[j]!=targetTeamNumber);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">for</span> (i=0; i &lt; teamMembers.Size(); i++)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <span class="keywordflow">if</span> (teamMembers[i].currentTeam==sourceTeamNumbers[j])</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                <span class="keywordflow">if</span> (teamMembers[i].requestedTeam==targetTeamNumber)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                    preferredSwapIndices.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a771fc63e3b0d892fbb605a379a78bacb" title="Push an element at the end of the stack.">Push</a>(i,<a class="code" href="../../d8/db0/defines_8h.xhtml#a8661ec2137eef33a8cd0cd618a748871">_FILE_AND_LINE_</a>);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                    potentialSwapIndices.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a771fc63e3b0d892fbb605a379a78bacb" title="Push an element at the end of the stack.">Push</a>(i,<a class="code" href="../../d8/db0/defines_8h.xhtml#a8661ec2137eef33a8cd0cd618a748871">_FILE_AND_LINE_</a>);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">if</span> (preferredSwapIndices.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>()&gt;0)</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    {</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="keywordflow">return</span> preferredSwapIndices[ <a class="code" href="../../da/d82/_rand_8cpp.xhtml#a90046cfad3cc4ee544377abb9d435f34">randomMT</a>() % preferredSwapIndices.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>() ];</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (potentialSwapIndices.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>()&gt;0)</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keywordflow">return</span> potentialSwapIndices[ <a class="code" href="../../da/d82/_rand_8cpp.xhtml#a90046cfad3cc4ee544377abb9d435f34">randomMT</a>() % potentialSwapIndices.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>() ];</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) -1;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;}</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6c690cbd636eeecd6ad99dd0ab4ea761">TeamBalancer::SwitchMemberTeam</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> teamMemberIndex, <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> destinationTeam)</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;{</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[ teamMembers[teamMemberIndex].currentTeam ]=<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[ teamMembers[teamMemberIndex].currentTeam ]-1;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[ destinationTeam ]=<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[ destinationTeam ]+1;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    teamMembers[teamMemberIndex].currentTeam=destinationTeam;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">if</span> (teamMembers[teamMemberIndex].requestedTeam==destinationTeam)</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        teamMembers[teamMemberIndex].requestedTeam=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;}</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ae61f6eee03eee5bfe3cd32c973293f03">TeamBalancer::GetOverpopulatedTeams</a>(<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml" title="Array based implementation of a list.">DataStructures::List&lt;TeamId&gt;</a> &amp;overpopulatedTeams, <span class="keywordtype">int</span> maxTeamSize)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;{</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    overpopulatedTeams.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a34219a5ce92981102d06fb1da7842a6b" title="Clear the list.">Clear</a>(<span class="keyword">true</span>,<a class="code" href="../../d8/db0/defines_8h.xhtml#a8661ec2137eef33a8cd0cd618a748871">_FILE_AND_LINE_</a>);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> i=0; i &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); i++)</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[i]&gt;=maxTeamSize)</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            overpopulatedTeams.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a771fc63e3b0d892fbb605a379a78bacb" title="Push an element at the end of the stack.">Push</a>(i,<a class="code" href="../../d8/db0/defines_8h.xhtml#a8661ec2137eef33a8cd0cd618a748871">_FILE_AND_LINE_</a>);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;}</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a640c6b8c086c6d5ed53eb255a8bb2c37">TeamBalancer::NotifyTeamAssigment</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> teamMemberIndex)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;{</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>(teamMemberIndex &lt; teamMembers.Size());</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">if</span> (teamMemberIndex&gt;=teamMembers.Size())</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">BitStream</a> bsOut;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5b5b9eb3be9ad636af02da44b718a75f" title="First byte of a network message.">MessageID</a>)<a class="code" href="../../d6/d83/_message_identifiers_8h.xhtml#ac1b471af280629f5ace02e586d5bcfd3a42266a19aa17158f228bf0baaec39e6d" title="Team balancer plugin informing you of your team. Byte 1 contains the team you requested to join...">ID_TEAM_BALANCER_TEAM_ASSIGNED</a>);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(teamMembers[teamMemberIndex].currentTeam);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(teamMembers[teamMemberIndex].memberId);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#adac8deadf450a4e1d69c11b1db588bec">rakPeerInterface</a>-&gt;<a class="code" href="../../da/d27/class_s_l_net_1_1_rak_peer_interface.xhtml#ab817d74d4aa4ff1edf593543bbf7b8fb">Send</a>(&amp;bsOut,<a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#a659378374e516180f93640c79f59705cacb1785f11dd02aa7f5d164fb314c594e">HIGH_PRIORITY</a>,<a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#ae41fa01235e99dced384d137fa874a7eaff2d39b163bcf3e142744962bfb0849f">RELIABLE_ORDERED</a>,0,teamMembers[teamMemberIndex].memberGuid,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;}</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a13952460534e1d57791877d8c5e39d62">TeamBalancer::WeAreHost</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa3c42a43e69f0241998fa7733ae7d5b0">hostGuid</a>==<a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#adac8deadf450a4e1d69c11b1db588bec">rakPeerInterface</a>-&gt;<a class="code" href="../../da/d27/class_s_l_net_1_1_rak_peer_interface.xhtml#a19e5960d76ee5af2ca108978daa2fcff">GetGuidFromSystemAddress</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#acea7714c995aae0e1feaf79c9e7f073d" title="Index of an invalid SystemAddress.">UNASSIGNED_SYSTEM_ADDRESS</a>);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;}</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#ga5c8f613a7c294e0b96deccbdabc38f18">PluginReceiveResult</a> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#af36e3ddab2655bc7beae5366edff5597">TeamBalancer::OnTeamAssigned</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#d8/d23/struct_s_l_net_1_1_packet" title="This represents a user message from another system.">Packet</a> *packet)</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;{</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">if</span> (packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a4f42e82893aff6aade8a45c79d1b8fd3">guid</a>!=<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa3c42a43e69f0241998fa7733ae7d5b0">hostGuid</a>)</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#gga5c8f613a7c294e0b96deccbdabc38f18a9f27ed7ccb7513dceb7ed4da3d99a1bf" title="The plugin used this message and it shouldn&#39;t be given to the user.">RR_STOP_PROCESSING_AND_DEALLOCATE</a>;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">BitStream</a> bsIn(packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aff6d115daef2787d582f9a20efd64fc0" title="The data from the sender.">data</a>,packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a75dfd0a23cc4c14dd338caedabe19341" title="The length of the data in bytes.">length</a>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    bsIn.IgnoreBytes(1);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    MyTeamMembers mtm;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    bsIn.Read(mtm.currentTeam);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    bsIn.Read(mtm.memberId);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    mtm.requestedTeam=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordtype">bool</span> foundMatch=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); i++)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].memberId==mtm.memberId)</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            foundMatch=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].requestedTeam==mtm.currentTeam)</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].requestedTeam=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6a651d20ab14bfd7864b5880c9658c23">myTeamMembers</a>[i].currentTeam=mtm.currentTeam;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        }</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordflow">if</span> (foundMatch==<span class="keyword">false</span>)</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#gga5c8f613a7c294e0b96deccbdabc38f18a9f27ed7ccb7513dceb7ed4da3d99a1bf" title="The plugin used this message and it shouldn&#39;t be given to the user.">RR_STOP_PROCESSING_AND_DEALLOCATE</a>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#gga5c8f613a7c294e0b96deccbdabc38f18a5b5a476b87be78212057efd5535345d4" title="This message will be processed by other plugins, and at last by the user.">RR_CONTINUE_PROCESSING</a>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;}</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#ga5c8f613a7c294e0b96deccbdabc38f18">PluginReceiveResult</a> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#adab0082143b910fd28cf75b4f6e66db8">TeamBalancer::OnRequestedTeamChangePending</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#d8/d23/struct_s_l_net_1_1_packet" title="This represents a user message from another system.">Packet</a> *packet)</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;{</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">if</span> (packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a4f42e82893aff6aade8a45c79d1b8fd3">guid</a>!=<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa3c42a43e69f0241998fa7733ae7d5b0">hostGuid</a>)</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#gga5c8f613a7c294e0b96deccbdabc38f18a9f27ed7ccb7513dceb7ed4da3d99a1bf" title="The plugin used this message and it shouldn&#39;t be given to the user.">RR_STOP_PROCESSING_AND_DEALLOCATE</a>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#gga5c8f613a7c294e0b96deccbdabc38f18a5b5a476b87be78212057efd5535345d4" title="This message will be processed by other plugins, and at last by the user.">RR_CONTINUE_PROCESSING</a>;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;}</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#ga5c8f613a7c294e0b96deccbdabc38f18">PluginReceiveResult</a> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ae23db2796a8c0b2e12c2e3a80be599d6">TeamBalancer::OnTeamsLocked</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#d8/d23/struct_s_l_net_1_1_packet" title="This represents a user message from another system.">Packet</a> *packet)</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;{</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">if</span> (packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a4f42e82893aff6aade8a45c79d1b8fd3">guid</a>!=<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa3c42a43e69f0241998fa7733ae7d5b0">hostGuid</a>)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#gga5c8f613a7c294e0b96deccbdabc38f18a9f27ed7ccb7513dceb7ed4da3d99a1bf" title="The plugin used this message and it shouldn&#39;t be given to the user.">RR_STOP_PROCESSING_AND_DEALLOCATE</a>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#gga5c8f613a7c294e0b96deccbdabc38f18a5b5a476b87be78212057efd5535345d4" title="This message will be processed by other plugins, and at last by the user.">RR_CONTINUE_PROCESSING</a>;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;}</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a7022b3909c60d61c840248aa9d697467">TeamBalancer::GetNextDefaultTeam</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;{</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="comment">// Accounting for team balancing and team limits, get the team a player should be placed on</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ad27f26da1665bd2c57dc78b37a43ffa0">defaultAssigmentAlgorithm</a>)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a9de4a32384ccb28ce300c12d481ae4a8a16f2fe8d8b3fd59cb2170af9fc6e4936" title="Among all the teams, join the team with the smallest number of players.">SMALLEST_TEAM</a>:</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#af3c1b9bd5ca0b131f97069c8a4530442">GetSmallestNonFullTeam</a>();</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a9de4a32384ccb28ce300c12d481ae4a8a516cef9912a5dac4ea90bf6bd656e824" title="Join the team with the lowest index that has open slots.">FILL_IN_ORDER</a>:</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a074e016c371eaba9389fd9312e86d93b">GetFirstNonFullTeam</a>();</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>(<span class="stringliteral">&quot;TeamBalancer::GetNextDefaultTeam unknown algorithm enumeration&quot;</span> &amp;&amp; 0);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;}</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a93c9124d5f9801ccc15b89aa7ccbef2b">TeamBalancer::TeamWouldBeOverpopulatedOnAddition</a>(<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> teamId, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> teamMemberSize)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;{</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">// Accounting for team balancing and team limits, would this team be overpopulated if a member was added to it?</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[teamId]&gt;=<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>[teamId])</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#acc6eb35f9bf7f2c362e2630b221e1127">forceTeamsToBeEven</a>)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="keywordtype">int</span> allowedLimit = teamMemberSize/<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>() + 1;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[teamId]&gt;=allowedLimit;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;}</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a0e53627909c328838fa06757e49cdcc0">TeamBalancer::TeamWouldBeUnderpopulatedOnLeave</a>(<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> teamId, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> teamMemberSize)</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;{</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#acc6eb35f9bf7f2c362e2630b221e1127">forceTeamsToBeEven</a>)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> minMembersOnASingleTeam = (teamMemberSize-1)/<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>();</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[teamId]&lt;=minMembersOnASingleTeam;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;}</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#af3c1b9bd5ca0b131f97069c8a4530442">TeamBalancer::GetSmallestNonFullTeam</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> idx;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> smallestTeamCount=<a class="code" href="../../d9/d7f/_d_s___list_8h.xhtml#afc42e3d98c21b07bd24b47aeb8ef2561" title="Maximum unsigned long.">MAX_UNSIGNED_LONG</a>;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> smallestTeamIndex = <a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordflow">for</span> (idx=0; idx &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); idx++)</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[idx]&lt;smallestTeamCount &amp;&amp; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[idx]&lt;<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>[idx])</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            smallestTeamCount=<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[idx];</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            smallestTeamIndex=idx;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    }</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keywordflow">return</span> smallestTeamIndex;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;}</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a074e016c371eaba9389fd9312e86d93b">TeamBalancer::GetFirstNonFullTeam</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> idx;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">for</span> (idx=0; idx &lt; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>(); idx++)</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a561474def50d400a6c045a8874ceb45a">teamMemberCounts</a>[idx]&lt;<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#aa18fc510021faae624d4ee375fbd46b2">teamLimits</a>[idx])</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="keywordflow">return</span> idx;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        }</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;}</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a72f2dea409a28878b594b1e814285ee9">TeamBalancer::MoveMemberThatWantsToJoinTeam</a>(<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> teamId)</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;{</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>(<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#acc6eb35f9bf7f2c362e2630b221e1127">forceTeamsToBeEven</a>==<span class="keyword">false</span> &amp;&amp; <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#adf1751df350b21316db4b20146cc9a41">lockTeams</a>==<span class="keyword">false</span>);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">do</span> </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        teamId = <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ab7662b490741e2845a6daeece9ac5cad">MoveMemberThatWantsToJoinTeamInternal</a>(teamId);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    } <span class="keywordflow">while</span> (teamId!=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;}</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#ab7662b490741e2845a6daeece9ac5cad">TeamBalancer::MoveMemberThatWantsToJoinTeamInternal</a>(<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> teamId)</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;{</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml" title="Array based implementation of a list.">DataStructures::List&lt;TeamId&gt;</a> membersThatWantToJoinTheTeam;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> i=0; i &lt; teamMembers.Size(); i++)</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    {</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordflow">if</span> (teamMembers[i].requestedTeam==teamId)</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            membersThatWantToJoinTheTeam.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a771fc63e3b0d892fbb605a379a78bacb" title="Push an element at the end of the stack.">Push</a>(i,<a class="code" href="../../d8/db0/defines_8h.xhtml#a8661ec2137eef33a8cd0cd618a748871">_FILE_AND_LINE_</a>);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">if</span> (membersThatWantToJoinTheTeam.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>()&gt;0)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> oldTeam;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> swappedMemberIndex = membersThatWantToJoinTheTeam[ <a class="code" href="../../da/d82/_rand_8cpp.xhtml#a90046cfad3cc4ee544377abb9d435f34">randomMT</a>() % membersThatWantToJoinTheTeam.<a class="code" href="../../d4/d78/class_data_structures_1_1_list.xhtml#a6f13a4519693cbd16cd13b1fe284f330">Size</a>() ];</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        oldTeam=teamMembers[swappedMemberIndex].currentTeam;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a6c690cbd636eeecd6ad99dd0ab4ea761">SwitchMemberTeam</a>(swappedMemberIndex,teamId);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a640c6b8c086c6d5ed53eb255a8bb2c37">NotifyTeamAssigment</a>(swappedMemberIndex);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="keywordflow">return</span> oldTeam;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;}</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a1b5a34d8101604857f0a575fc6c6f23c">TeamBalancer::NotifyTeamsLocked</a>(<a class="code" href="../../dd/d3f/struct_s_l_net_1_1_rak_net_g_u_i_d.xhtml">RakNetGUID</a> target, <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> requestedTeam)</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;{</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">BitStream</a> bsOut;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5b5b9eb3be9ad636af02da44b718a75f" title="First byte of a network message.">MessageID</a>)<a class="code" href="../../d6/d83/_message_identifiers_8h.xhtml#ac1b471af280629f5ace02e586d5bcfd3ac083d8c4da64d860c0ef882c6e140a94">ID_TEAM_BALANCER_REQUESTED_TEAM_LOCKED</a>);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(requestedTeam);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#adac8deadf450a4e1d69c11b1db588bec">rakPeerInterface</a>-&gt;<a class="code" href="../../da/d27/class_s_l_net_1_1_rak_peer_interface.xhtml#ab817d74d4aa4ff1edf593543bbf7b8fb">Send</a>(&amp;bsOut,<a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#a659378374e516180f93640c79f59705cacb1785f11dd02aa7f5d164fb314c594e">HIGH_PRIORITY</a>,<a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#ae41fa01235e99dced384d137fa874a7eaff2d39b163bcf3e142744962bfb0849f">RELIABLE_ORDERED</a>,0,target,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;}</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a3d933edb5bdd683ac8c7457ea77d5193">TeamBalancer::NotifyTeamSwitchPending</a>(<a class="code" href="../../dd/d3f/struct_s_l_net_1_1_rak_net_g_u_i_d.xhtml">RakNetGUID</a> target, <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> requestedTeam, <a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aa616a13e58b2ffd2c3161609610b256d">NetworkID</a> memberId)</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;{</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">BitStream</a> bsOut;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5b5b9eb3be9ad636af02da44b718a75f" title="First byte of a network message.">MessageID</a>)<a class="code" href="../../d6/d83/_message_identifiers_8h.xhtml#ac1b471af280629f5ace02e586d5bcfd3a1f19168e95bb4a33feccb5e04c662817">ID_TEAM_BALANCER_REQUESTED_TEAM_FULL</a>);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(requestedTeam);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(memberId);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#adac8deadf450a4e1d69c11b1db588bec">rakPeerInterface</a>-&gt;<a class="code" href="../../da/d27/class_s_l_net_1_1_rak_peer_interface.xhtml#ab817d74d4aa4ff1edf593543bbf7b8fb">Send</a>(&amp;bsOut,<a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#a659378374e516180f93640c79f59705cacb1785f11dd02aa7f5d164fb314c594e">HIGH_PRIORITY</a>,<a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#ae41fa01235e99dced384d137fa874a7eaff2d39b163bcf3e142744962bfb0849f">RELIABLE_ORDERED</a>,0,target,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;}</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a76e20bdfc5228c50474115d26677d4a5">TeamBalancer::SwapTeamMembersByRequest</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> memberIndex1, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> memberIndex2)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;{</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> index1Team = teamMembers[memberIndex1].currentTeam;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    teamMembers[memberIndex1].currentTeam=teamMembers[memberIndex2].currentTeam;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    teamMembers[memberIndex2].currentTeam=index1Team;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    teamMembers[memberIndex1].requestedTeam=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    teamMembers[memberIndex2].requestedTeam=<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;}</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a144df7a27a6f10e9aabe676a762d9270">TeamBalancer::NotifyNoTeam</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aa616a13e58b2ffd2c3161609610b256d">NetworkID</a> memberId, <a class="code" href="../../dd/d3f/struct_s_l_net_1_1_rak_net_g_u_i_d.xhtml">RakNetGUID</a> target)</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;{</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">BitStream</a> bsOut;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5b5b9eb3be9ad636af02da44b718a75f" title="First byte of a network message.">MessageID</a>)ID_TEAM_BALANCER_TEAM_ASSIGNED);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)<a class="code" href="../../d1/de0/_team_balancer_8h.xhtml#a476ded4e04839a048c089628e993250a">UNASSIGNED_TEAM_ID</a>);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    bsOut.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(memberId);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#adac8deadf450a4e1d69c11b1db588bec">rakPeerInterface</a>-&gt;<a class="code" href="../../da/d27/class_s_l_net_1_1_rak_peer_interface.xhtml#ab817d74d4aa4ff1edf593543bbf7b8fb">Send</a>(&amp;bsOut,<a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#a659378374e516180f93640c79f59705cacb1785f11dd02aa7f5d164fb314c594e">HIGH_PRIORITY</a>,<a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#ae41fa01235e99dced384d137fa874a7eaff2d39b163bcf3e142744962bfb0849f">RELIABLE_ORDERED</a>,0,target,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;}</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a3767f4e0d9ff145ca455ca423fb9687c">TeamBalancer::TeamsWouldBeEvenOnSwitch</a>(<a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> t1, <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#gaa4be742616eef09f76f4a74f8bb8b9f7">TeamId</a> t2)</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;{</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>(teamMembers.Size()!=0);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a93c9124d5f9801ccc15b89aa7ccbef2b">TeamWouldBeOverpopulatedOnAddition</a>(t1, teamMembers.Size()-1)==<span class="keyword">false</span> &amp;&amp;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <a class="code" href="../../d7/dfc/group___t_e_a_m___b_a_l_a_n_c_e_r___g_r_o_u_p.xhtml#a0e53627909c328838fa06757e49cdcc0">TeamWouldBeUnderpopulatedOnLeave</a>(t2, teamMembers.Size()-1)==<span class="keyword">false</span>;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;}</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="preprocessor">#endif // _RAKNET_SUPPORT_*</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_74389ed8173ad57b461b9d623a1f3867.xhtml">Source</a></li><li class="navelem"><a class="el" href="../../dir_d1eb22c2ecfd8b50f59e9cbaf8260105.xhtml">src</a></li><li class="navelem"><a class="el" href="../../dc/d8f/_team_balancer_8cpp.xhtml">TeamBalancer.cpp</a></li>
    <li class="footer">Generated on Wed Aug 14 2019 22:09:48 for SLikeNet by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.2 </li>
  </ul>
</div>
</body>
</html>
