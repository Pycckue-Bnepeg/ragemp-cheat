<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>SLikeNet: Source/src/UDPProxyServer.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SLikeNet
   &#160;<span id="projectnumber">0.1.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.xhtml"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.xhtml"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.xhtml"><span>Modules</span></a></li>
      <li><a href="../../namespaces.xhtml"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.xhtml"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.xhtml"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.xhtml"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.xhtml"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d1/d44/_u_d_p_proxy_server_8cpp_source.xhtml','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">UDPProxyServer.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d1/d44/_u_d_p_proxy_server_8cpp.xhtml">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *  Original work: Copyright (c) 2014, Oculus VR, Inc.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  All rights reserved.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *  This source code is licensed under the BSD-style license found in the</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *  RakNet License.txt file in the licenses directory of this source tree. An additional grant </span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *  of patent rights can be found in the RakNet Patents.txt file in the same directory.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *  Modified work: Copyright (c) 2017, SLikeSoft UG (haftungsbeschr√§nkt)</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *  This source code was modified by SLikeSoft. Modifications are licensed under the MIT-style</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *  license found in the license.txt file in the root directory of this source tree.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/ddb/_native_feature_includes_8h.xhtml">slikenet/NativeFeatureIncludes.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#if _RAKNET_SUPPORT_UDPProxyServer==1 &amp;&amp; _RAKNET_SUPPORT_UDPForwarder==1</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d70/_u_d_p_proxy_server_8h.xhtml" title="A RakNet plugin performing networking to communicate with UDPProxyServer. It allows UDPProxyServer to...">slikenet/UDPProxyServer.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/dc3/_bit_stream_8h.xhtml" title="This class allows you to write and read native types as a string of bits.">slikenet/BitStream.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/de7/_u_d_p_proxy_common_8h.xhtml">slikenet/UDPProxyCommon.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d85/peerinterface_8h.xhtml" title="An interface for RakPeer. Simply contains all user functions as pure virtuals.">slikenet/peerinterface.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/d83/_message_identifiers_8h.xhtml" title="All the message identifiers used by RakNet. Message identifiers comprise the first byte of any messag...">slikenet/MessageIdentifiers.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">using namespace </span>SLNet;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<a class="code" href="../../db/dbd/_export_8h.xhtml#aa00165c970bdb25e1c757b432509533b">STATIC_FACTORY_DEFINITIONS</a>(<a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#d4/d29/class_s_l_net_1_1_u_d_p_proxy_server" title="UDPProxyServer to control our instance of UDPForwarder.">UDPProxyServer</a>,<a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#d4/d29/class_s_l_net_1_1_u_d_p_proxy_server" title="UDPProxyServer to control our instance of UDPForwarder.">UDPProxyServer</a>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a77fa21b842895898e98b87a7cbf7c595">UDPProxyServer::UDPProxyServer</a>()</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a746e0c4d313eda4697ae8957839dda12">resultHandler</a>=0;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a5d008bdeef4fa0ae8c21d2065a30cff4">socketFamily</a>=AF_INET;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;}</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#aaacf2671a231a49c841afff2966e33cb">UDPProxyServer::~UDPProxyServer</a>()</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a137695e31f65ae64d353f82aa8f943fd">UDPProxyServer::SetSocketFamily</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> _socketFamily)</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;{</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a5d008bdeef4fa0ae8c21d2065a30cff4">socketFamily</a>=_socketFamily;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;}</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a5706bcfe2e5e1f04e56426f73341e1c0">UDPProxyServer::SetResultHandler</a>(<a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#db/dbc/struct_s_l_net_1_1_u_d_p_proxy_server_result_handler">UDPProxyServerResultHandler</a> *rh)</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a746e0c4d313eda4697ae8957839dda12">resultHandler</a>=rh;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a2cec3428cbdfcabde03438a1eef32ad4">UDPProxyServer::LoginToCoordinator</a>(<a class="code" href="../../d2/d66/class_s_l_net_1_1_rak_string.xhtml" title="String class.">SLNet::RakString</a> password, <a class="code" href="../../d8/dbe/struct_s_l_net_1_1_system_address.xhtml" title="Network address for a system.">SystemAddress</a> coordinatorAddress)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> insertionIndex;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">bool</span> objectExists;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    insertionIndex=<a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#ab2d05c76362492e49f40489feb3f1a84">loggingInCoordinators</a>.<a class="code" href="../../da/dfc/class_data_structures_1_1_ordered_list.xhtml#a54b7abdd81f650f9d1755a4fd56b1aaa">GetIndexFromKey</a>(coordinatorAddress,&amp;objectExists);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (objectExists==<span class="keyword">true</span>)</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#ae7462ffbb9e269b09ceeaa3215d8e7bb">loggedInCoordinators</a>.<a class="code" href="../../da/dfc/class_data_structures_1_1_ordered_list.xhtml#a54b7abdd81f650f9d1755a4fd56b1aaa">GetIndexFromKey</a>(coordinatorAddress,&amp;objectExists);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">if</span> (objectExists==<span class="keyword">true</span>)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">SLNet::BitStream</a> outgoingBs;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    outgoingBs.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5b5b9eb3be9ad636af02da44b718a75f" title="First byte of a network message.">MessageID</a>)<a class="code" href="../../d6/d83/_message_identifiers_8h.xhtml#ac1b471af280629f5ace02e586d5bcfd3ad56b0bee1058a1be9f8634faeeb94874" title="UDP proxy messages. Second byte indicates type.">ID_UDP_PROXY_GENERAL</a>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    outgoingBs.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5b5b9eb3be9ad636af02da44b718a75f" title="First byte of a network message.">MessageID</a>)<a class="code" href="../../d7/de7/_u_d_p_proxy_common_8h.xhtml#a29484f0e9e8b610f2ef941aa44a1f9a2a647a1f35adc22c996485e6a0795f6fb9">ID_UDP_PROXY_LOGIN_REQUEST_FROM_SERVER_TO_COORDINATOR</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    outgoingBs.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(password);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#adac8deadf450a4e1d69c11b1db588bec">rakPeerInterface</a>-&gt;<a class="code" href="../../da/d27/class_s_l_net_1_1_rak_peer_interface.xhtml#ab817d74d4aa4ff1edf593543bbf7b8fb">Send</a>(&amp;outgoingBs, <a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#a659378374e516180f93640c79f59705ca06b314d863076d54942e065d90c179c4">MEDIUM_PRIORITY</a>, <a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#ae41fa01235e99dced384d137fa874a7eaff2d39b163bcf3e142744962bfb0849f">RELIABLE_ORDERED</a>, 0, coordinatorAddress, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#ab2d05c76362492e49f40489feb3f1a84">loggingInCoordinators</a>.<a class="code" href="../../da/dfc/class_data_structures_1_1_ordered_list.xhtml#a9ed08b2c35b20d08ebfab17927f5c4a2">InsertAtIndex</a>(coordinatorAddress, insertionIndex, <a class="code" href="../../d8/db0/defines_8h.xhtml#a8661ec2137eef33a8cd0cd618a748871">_FILE_AND_LINE_</a> );</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#adbc6fc1d3650a8b11a15d1c5c6439cad" title="The server IP reported to the client is the IP address from the server to the coordinator. If the server and coordinator are on the same LAN, you need to call SetServerPublicIP() to tell the client what address to connect to.">UDPProxyServer::SetServerPublicIP</a>(<a class="code" href="../../d2/d66/class_s_l_net_1_1_rak_string.xhtml" title="String class.">RakString</a> ip)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a0d9196757aeff878f0d2c97bf013ac12">serverPublicIp</a> = ip;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;}</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#aeb797f22d5e637597174392c6b1c88ab" title="Update is called every time a packet is checked for .">UDPProxyServer::Update</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;{</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#ga5c8f613a7c294e0b96deccbdabc38f18">PluginReceiveResult</a> <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#ae950745fe0b0f4850dd7af3485bb4248">UDPProxyServer::OnReceive</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#d8/d23/struct_s_l_net_1_1_packet" title="This represents a user message from another system.">Packet</a> *packet)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// Make sure incoming messages from from UDPProxyCoordinator</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">if</span> (packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aff6d115daef2787d582f9a20efd64fc0" title="The data from the sender.">data</a>[0]==ID_UDP_PROXY_GENERAL &amp;&amp; packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a75dfd0a23cc4c14dd338caedabe19341" title="The length of the data in bytes.">length</a>&gt;1)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordtype">bool</span> objectExists;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">switch</span> (packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aff6d115daef2787d582f9a20efd64fc0" title="The data from the sender.">data</a>[1])</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/de7/_u_d_p_proxy_common_8h.xhtml#a29484f0e9e8b610f2ef941aa44a1f9a2a8507758530db866a6607c6822ac81f59">ID_UDP_PROXY_FORWARDING_REQUEST_FROM_COORDINATOR_TO_SERVER</a>:</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#ae7462ffbb9e269b09ceeaa3215d8e7bb">loggedInCoordinators</a>.<a class="code" href="../../da/dfc/class_data_structures_1_1_ordered_list.xhtml#a54b7abdd81f650f9d1755a4fd56b1aaa">GetIndexFromKey</a>(packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5c9d18515892239712a5d8fcb46c4245" title="The system that send this packet.">systemAddress</a>, &amp;objectExists)!=(<span class="keywordtype">unsigned</span> int)-1)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#abe228118b48f8aa16dfa5450ec835179">OnForwardingRequestFromCoordinatorToServer</a>(packet);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#gga5c8f613a7c294e0b96deccbdabc38f18a9f27ed7ccb7513dceb7ed4da3d99a1bf" title="The plugin used this message and it shouldn&#39;t be given to the user.">RR_STOP_PROCESSING_AND_DEALLOCATE</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/de7/_u_d_p_proxy_common_8h.xhtml#a29484f0e9e8b610f2ef941aa44a1f9a2af3ff7449888a51faa00d646c6cb64ff6">ID_UDP_PROXY_NO_PASSWORD_SET_FROM_COORDINATOR_TO_SERVER</a>:</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/de7/_u_d_p_proxy_common_8h.xhtml#a29484f0e9e8b610f2ef941aa44a1f9a2a40430d873d9fec017ca35cfd20d4ced9">ID_UDP_PROXY_WRONG_PASSWORD_FROM_COORDINATOR_TO_SERVER</a>:</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/de7/_u_d_p_proxy_common_8h.xhtml#a29484f0e9e8b610f2ef941aa44a1f9a2a7c6c52f9d67f41549b178d15b7764da2">ID_UDP_PROXY_ALREADY_LOGGED_IN_FROM_COORDINATOR_TO_SERVER</a>:</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/de7/_u_d_p_proxy_common_8h.xhtml#a29484f0e9e8b610f2ef941aa44a1f9a2a28d2d640e82dabf2d16f8d6a7e26a885">ID_UDP_PROXY_LOGIN_SUCCESS_FROM_COORDINATOR_TO_SERVER</a>:</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> removalIndex = <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#ab2d05c76362492e49f40489feb3f1a84">loggingInCoordinators</a>.<a class="code" href="../../da/dfc/class_data_structures_1_1_ordered_list.xhtml#a54b7abdd81f650f9d1755a4fd56b1aaa">GetIndexFromKey</a>(packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5c9d18515892239712a5d8fcb46c4245" title="The system that send this packet.">systemAddress</a>, &amp;objectExists);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                <span class="keywordflow">if</span> (objectExists)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                    <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#ab2d05c76362492e49f40489feb3f1a84">loggingInCoordinators</a>.<a class="code" href="../../da/dfc/class_data_structures_1_1_ordered_list.xhtml#a65ef0eca14deb8698004b1cd074b6f0a">RemoveAtIndex</a>(removalIndex);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                    <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">SLNet::BitStream</a> incomingBs(packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aff6d115daef2787d582f9a20efd64fc0" title="The data from the sender.">data</a>, packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a75dfd0a23cc4c14dd338caedabe19341" title="The length of the data in bytes.">length</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                    incomingBs.IgnoreBytes(2);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                    <a class="code" href="../../d2/d66/class_s_l_net_1_1_rak_string.xhtml" title="String class.">SLNet::RakString</a> password;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                    incomingBs.Read(password);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                    <span class="keywordflow">switch</span> (packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aff6d115daef2787d582f9a20efd64fc0" title="The data from the sender.">data</a>[1])</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                    {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="../../d7/de7/_u_d_p_proxy_common_8h.xhtml#a29484f0e9e8b610f2ef941aa44a1f9a2af3ff7449888a51faa00d646c6cb64ff6">ID_UDP_PROXY_NO_PASSWORD_SET_FROM_COORDINATOR_TO_SERVER</a>:</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a746e0c4d313eda4697ae8957839dda12">resultHandler</a>)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                            <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a746e0c4d313eda4697ae8957839dda12">resultHandler</a>-&gt;<a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a2a34d2e34e21af4110d3fd9a529799cf">OnNoPasswordSet</a>(password, <span class="keyword">this</span>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="../../d7/de7/_u_d_p_proxy_common_8h.xhtml#a29484f0e9e8b610f2ef941aa44a1f9a2a40430d873d9fec017ca35cfd20d4ced9">ID_UDP_PROXY_WRONG_PASSWORD_FROM_COORDINATOR_TO_SERVER</a>:</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a746e0c4d313eda4697ae8957839dda12">resultHandler</a>)</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                            <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a746e0c4d313eda4697ae8957839dda12">resultHandler</a>-&gt;<a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a9131a8b41895ed968bf9db758a096370">OnWrongPassword</a>(password, <span class="keyword">this</span>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="../../d7/de7/_u_d_p_proxy_common_8h.xhtml#a29484f0e9e8b610f2ef941aa44a1f9a2a7c6c52f9d67f41549b178d15b7764da2">ID_UDP_PROXY_ALREADY_LOGGED_IN_FROM_COORDINATOR_TO_SERVER</a>:</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a746e0c4d313eda4697ae8957839dda12">resultHandler</a>)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                            <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a746e0c4d313eda4697ae8957839dda12">resultHandler</a>-&gt;<a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a691e822395419240ceea85a4c013b566">OnAlreadyLoggedIn</a>(password, <span class="keyword">this</span>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="../../d7/de7/_u_d_p_proxy_common_8h.xhtml#a29484f0e9e8b610f2ef941aa44a1f9a2a28d2d640e82dabf2d16f8d6a7e26a885">ID_UDP_PROXY_LOGIN_SUCCESS_FROM_COORDINATOR_TO_SERVER</a>:</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                        <span class="comment">// RakAssert(loggedInCoordinators.GetIndexOf(packet-&gt;systemAddress)==(unsigned int)-1);</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                        <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#ae7462ffbb9e269b09ceeaa3215d8e7bb">loggedInCoordinators</a>.<a class="code" href="../../da/dfc/class_data_structures_1_1_ordered_list.xhtml#a30d44cd52bdb782478472a95cc5a4b0a">Insert</a>(packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5c9d18515892239712a5d8fcb46c4245" title="The system that send this packet.">systemAddress</a>, packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5c9d18515892239712a5d8fcb46c4245" title="The system that send this packet.">systemAddress</a>, <span class="keyword">true</span>, <a class="code" href="../../d8/db0/defines_8h.xhtml#a8661ec2137eef33a8cd0cd618a748871">_FILE_AND_LINE_</a>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a746e0c4d313eda4697ae8957839dda12">resultHandler</a>)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                            <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a746e0c4d313eda4697ae8957839dda12">resultHandler</a>-&gt;<a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#aaa410e4ba3454b1094e53d997188f75c">OnLoginSuccess</a>(password, <span class="keyword">this</span>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#gga5c8f613a7c294e0b96deccbdabc38f18a9f27ed7ccb7513dceb7ed4da3d99a1bf" title="The plugin used this message and it shouldn&#39;t be given to the user.">RR_STOP_PROCESSING_AND_DEALLOCATE</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#gga5c8f613a7c294e0b96deccbdabc38f18a5b5a476b87be78212057efd5535345d4" title="This message will be processed by other plugins, and at last by the user.">RR_CONTINUE_PROCESSING</a>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a4c07309c470ecda59be461ee4987fe18">UDPProxyServer::OnClosedConnection</a>(<span class="keyword">const</span> <a class="code" href="../../d8/dbe/struct_s_l_net_1_1_system_address.xhtml" title="Network address for a system.">SystemAddress</a> &amp;systemAddress, <a class="code" href="../../dd/d3f/struct_s_l_net_1_1_rak_net_g_u_i_d.xhtml">RakNetGUID</a> rakNetGUID, <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#ga4d3ac5ca8821fadad6d22d0267e06803">PI2_LostConnectionReason</a> lostConnectionReason )</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;{</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    (void) lostConnectionReason;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    (void) rakNetGUID;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#ab2d05c76362492e49f40489feb3f1a84">loggingInCoordinators</a>.<a class="code" href="../../da/dfc/class_data_structures_1_1_ordered_list.xhtml#a5c05db993081fec4efcd3fd6f3eb34e2">RemoveIfExists</a>(systemAddress);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#ae7462ffbb9e269b09ceeaa3215d8e7bb">loggedInCoordinators</a>.<a class="code" href="../../da/dfc/class_data_structures_1_1_ordered_list.xhtml#a5c05db993081fec4efcd3fd6f3eb34e2">RemoveIfExists</a>(systemAddress);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a0a7b92a30a869810c688d587c85f9d97" title="Called when RakPeer is initialized.">UDPProxyServer::OnRakPeerStartup</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;{</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#acbb762a0aa06c3e28700d33296fd901a">udpForwarder</a>.<a class="code" href="../../db/d81/group___n_a_t___p_u_n_c_h_t_h_r_o_u_g_h___g_r_o_u_p.xhtml#a88ad7d9bf51c75320f43701327d9a27c">Startup</a>();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#ae8c8524f568e061ff05699229c83a333" title="Called when RakPeer is shutdown.">UDPProxyServer::OnRakPeerShutdown</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;{</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#acbb762a0aa06c3e28700d33296fd901a">udpForwarder</a>.<a class="code" href="../../db/d81/group___n_a_t___p_u_n_c_h_t_h_r_o_u_g_h___g_r_o_u_p.xhtml#a46c8259451bc32d486faa2208d50413d" title="Stops the system, and frees all sockets.">Shutdown</a>();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#ab2d05c76362492e49f40489feb3f1a84">loggingInCoordinators</a>.<a class="code" href="../../da/dfc/class_data_structures_1_1_ordered_list.xhtml#ac3d85528ada636cae37a5474cb64b69c">Clear</a>(<span class="keyword">true</span>,<a class="code" href="../../d8/db0/defines_8h.xhtml#a8661ec2137eef33a8cd0cd618a748871">_FILE_AND_LINE_</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#ae7462ffbb9e269b09ceeaa3215d8e7bb">loggedInCoordinators</a>.<a class="code" href="../../da/dfc/class_data_structures_1_1_ordered_list.xhtml#ac3d85528ada636cae37a5474cb64b69c">Clear</a>(<span class="keyword">true</span>,<a class="code" href="../../d8/db0/defines_8h.xhtml#a8661ec2137eef33a8cd0cd618a748871">_FILE_AND_LINE_</a>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a7fae3a72d5ecf1cbe55a4eeca7d93690" title="Called when the interface is attached.">UDPProxyServer::OnAttach</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;{</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#adac8deadf450a4e1d69c11b1db588bec">rakPeerInterface</a>-&gt;<a class="code" href="../../da/d27/class_s_l_net_1_1_rak_peer_interface.xhtml#a50c7a3418a831307ead038c341e2f5df">IsActive</a>())</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a0a7b92a30a869810c688d587c85f9d97" title="Called when RakPeer is initialized.">OnRakPeerStartup</a>();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a032bd795291d94226ecf2181e03ce56b" title="Called when the interface is detached.">UDPProxyServer::OnDetach</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;{</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#ae8c8524f568e061ff05699229c83a333" title="Called when RakPeer is shutdown.">OnRakPeerShutdown</a>();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#abe228118b48f8aa16dfa5450ec835179">UDPProxyServer::OnForwardingRequestFromCoordinatorToServer</a>(<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#d8/d23/struct_s_l_net_1_1_packet" title="This represents a user message from another system.">Packet</a> *packet)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="../../d8/dbe/struct_s_l_net_1_1_system_address.xhtml" title="Network address for a system.">SystemAddress</a> sourceAddress, targetAddress;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">SLNet::BitStream</a> incomingBs(packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#aff6d115daef2787d582f9a20efd64fc0" title="The data from the sender.">data</a>, packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a75dfd0a23cc4c14dd338caedabe19341" title="The length of the data in bytes.">length</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    incomingBs.IgnoreBytes(2);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    incomingBs.Read(sourceAddress);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    incomingBs.Read(targetAddress);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a26b4eb1be8467562f791e3c5af4a67ae">SLNet::TimeMS</a> timeoutOnNoDataMS;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    incomingBs.Read(timeoutOnNoDataMS);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="../../d8/db0/defines_8h.xhtml#afaa3647d29f5960651eb23fd3d2b5368">RakAssert</a>(timeoutOnNoDataMS &gt; 0 &amp;&amp; timeoutOnNoDataMS &lt;= <a class="code" href="../../d7/de7/_u_d_p_proxy_common_8h.xhtml#a65d6f65937ccacd1d3056bf832b14cd2">UDP_FORWARDER_MAXIMUM_TIMEOUT</a>);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> forwardingPort=0;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a9751421209c1bbab6cc3b21c90de204c">UDPForwarderResult</a> success = <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#acbb762a0aa06c3e28700d33296fd901a">udpForwarder</a>.<a class="code" href="../../db/d81/group___n_a_t___p_u_n_c_h_t_h_r_o_u_g_h___g_r_o_u_p.xhtml#a7ffa0314e5718b17388e84ba720be7ed">StartForwarding</a>(sourceAddress, targetAddress, timeoutOnNoDataMS, 0, <a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a5d008bdeef4fa0ae8c21d2065a30cff4">socketFamily</a>, &amp;forwardingPort, 0);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml">SLNet::BitStream</a> outgoingBs;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    outgoingBs.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5b5b9eb3be9ad636af02da44b718a75f" title="First byte of a network message.">MessageID</a>)ID_UDP_PROXY_GENERAL);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    outgoingBs.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5b5b9eb3be9ad636af02da44b718a75f" title="First byte of a network message.">MessageID</a>)<a class="code" href="../../d7/de7/_u_d_p_proxy_common_8h.xhtml#a29484f0e9e8b610f2ef941aa44a1f9a2aec594366544af162006ee3caf54b7e3c">ID_UDP_PROXY_FORWARDING_REPLY_FROM_SERVER_TO_COORDINATOR</a>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    outgoingBs.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(sourceAddress);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    outgoingBs.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(targetAddress);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    outgoingBs.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(<a class="code" href="../../d1/d95/group___u_d_p___p_r_o_x_y___g_r_o_u_p.xhtml#a0d9196757aeff878f0d2c97bf013ac12">serverPublicIp</a>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    outgoingBs.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) success);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    outgoingBs.<a class="code" href="../../df/d75/class_s_l_net_1_1_bit_stream.xhtml#a2d1187ee508dc9d231d27aed1867d201" title="Write any integral type to a bitstream.">Write</a>(forwardingPort);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="../../de/d14/group___p_l_u_g_i_n___i_n_t_e_r_f_a_c_e___g_r_o_u_p.xhtml#adac8deadf450a4e1d69c11b1db588bec">rakPeerInterface</a>-&gt;<a class="code" href="../../da/d27/class_s_l_net_1_1_rak_peer_interface.xhtml#ab817d74d4aa4ff1edf593543bbf7b8fb">Send</a>(&amp;outgoingBs, <a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#a659378374e516180f93640c79f59705ca06b314d863076d54942e065d90c179c4">MEDIUM_PRIORITY</a>, <a class="code" href="../../d7/d03/_packet_priority_8h.xhtml#ae41fa01235e99dced384d137fa874a7eaff2d39b163bcf3e142744962bfb0849f">RELIABLE_ORDERED</a>, 0, packet-&gt;<a class="code" href="../../dd/d30/namespace_s_l_net.xhtml#a5c9d18515892239712a5d8fcb46c4245" title="The system that send this packet.">systemAddress</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor">#endif // _RAKNET_SUPPORT_*</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_74389ed8173ad57b461b9d623a1f3867.xhtml">Source</a></li><li class="navelem"><a class="el" href="../../dir_d1eb22c2ecfd8b50f59e9cbaf8260105.xhtml">src</a></li><li class="navelem"><a class="el" href="../../d1/d44/_u_d_p_proxy_server_8cpp.xhtml">UDPProxyServer.cpp</a></li>
    <li class="footer">Generated on Wed Aug 14 2019 22:09:48 for SLikeNet by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.2 </li>
  </ul>
</div>
</body>
</html>
